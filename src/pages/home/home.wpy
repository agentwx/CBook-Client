<style lang="less">
@import '../../less/mixin';

page {
  height: 100%;
}

.home-search-wrap {
  background-color: #fff;

  &.expand {
    .flex();
    flex-direction: column;
    height: 100%;
  }
}

.home-search {
  .flex-v-center();
  margin: 30rpx 20rpx;
  padding-left: 30rpx;
  background-color: #fff;
  border-radius: 60rpx;
  overflow: hidden;
  box-shadow: 0 0 40rpx rgba(0, 0, 0, 0.1);

  .icon-find {
    font-size: 36rpx;
    color: #888;
  }
}

.search-input {
  width: 100%;
  padding: 20rpx 30rpx 20rpx 16rpx;
  height: 80rpx;
}

.search-sublayer {
  flex: 1;
  padding: 20rpx;
}

.ssbl-hd {
  .flex-v-center();
  justify-content: space-between;
  margin-bottom: 20rpx;

  .ssbl-title {
    font-weight: bold;
  }

  .ssbl-icon {
    padding: 8rpx;
    font-size: 40rpx;
  }
}

.ssr-item {
  display: inline-block;
  padding: 8rpx 20rpx;
  border-radius: 60rpx;
  border: 2rpx solid @color-border;
  color: #888;
  font-size: 26rpx;
  margin-right: 16rpx;
  margin-bottom: 20rpx;

  &:active {
    border-color: darken(@color-border, 10%);
    color: #555;
  }
}

.home-banner {
  margin-left: 20rpx;
  margin-right: 20rpx;
  overflow: hidden;
  margin-bottom: 20rpx;
  border-radius: 12rpx;
  box-shadow: 0 10rpx 24rpx rgba(0, 0, 0, 0.08);
  image {
    width: 100%;
    display: block;
  }
}

.filter-toolbar {
  position: relative;
  .flex-v-center();
  justify-content: space-between;
  padding: 20rpx;

  .filter-itemtype {
    flex: 1;
    text-align: center;
    color: #666;

    &:first-child {
      text-align: left;

      &.selected {
        font-weight: bold;
        color: #333;
      }
    }

    &.selected {
      color: #27a1f8;
    }
  }
}

.filter-sublayer {
  position: absolute;
  left: 0;
  top: 100%;
  right: 0;
  background-color: #fff;
  box-shadow: 0 12rpx 24rpx rgba(0, 0, 0, 0.08);
}

.filter-itemsort-wrap {
  display: none;
}

.filter-itemsort {
  padding: 24rpx;
  .flex();
  justify-content: space-between;

  &.selected {
    color: #27a1f8;
    &:after {
      content: "\e92e";
      font-family: "iconfont";
      font-size: 36rpx;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  }

  &:active {
    background-color: @color-active;
  }
}

.filter-itemcatelog {
  padding: 20rpx 20rpx 0;
  display: none;
}

.filter-catelog-hd {
  .flex-v-center();
  margin-bottom: 30rpx;

  .icon {
    margin-right: 10rpx;
  }
}

.filter-catelog-bd {
  margin-bottom: 40rpx;
}

.filter-catelog-item {
  display: inline-block;
  padding: 8rpx 24rpx;
  border: 2rpx solid #ddd;
  border-radius: 60rpx;
  margin: 0 16rpx 16rpx 0;
  color: #666;
  font-size: 26rpx;

  &.selected {
    background-color: #daeaf6;
    border-color: #daeaf6;
    color: #27a1f8;
  }
}


.product-panel {
  .flex();
  padding: 20rpx;

  &:active {
    background-color: @color-active;
  }
}

.product-cover {
  width: 240rpx;
  margin-right: 24rpx;
  overflow: hidden;
 /* box-shadow: 0 0 20rpx rgba(0,0,0,.1), 10rpx 10rpx 16rpx rgba(0,0,0,0.04);*/

  > image {
    display: block;
    width: 100%;
  }
}

.product-panel-body {
  flex: 1;
  .flex();
  flex-direction: column;
  justify-content: space-between;

  .product-caption {
    font-size: 32rpx;
    color: #333;
    font-weight: bold;
    margin-bottom: 6rpx;
  }

  .product-author {
    color: #777;
  }

  .product-desc {
    font-size: 26rpx;
    color: #888;
    margin-top: 4rpx;
    margin-bottom: 16rpx;
  }

  .product-tags {
    margin-top: 20rpx;
  }
}

.product-subinfo {
  .flex-v-center();

  .product-price {
    font-size: 32rpx;
    color: #eb5a21;

    .unit {
      font-size: 24rpx;
      margin-right: 6rpx;
    }
  }

  .product-tax {
    color: #27a1f8;
  }

  .split {
    width: 0;
    display: inline-block;
    border-left: 2rpx solid #ddd;
    margin-left: 16rpx;
    margin-right: 16rpx;
    height: 30rpx;
  }
}
</style>
<template>
  <view class="home-search-wrap {{isSearchShow ? 'expand' : ''}}">
    <view class="home-search">
      <text class="iconfont icon-find"></text>
      <input type="text" class="search-input" placeholder="搜索书名、作者" @focus="showSearch" />
    </view>

    <view class="search-sublayer" wx:if="{{isSearchShow}}" @tap="hideSearch">
      <view class="ssbl-hd">
        <text class="ssbl-title">历史搜索</text>
        <text class="ssbl-icon iconfont icon-trash"></text>
      </view>
      <view class="search-history">
        <view class="ssr-item">小猪佩奇</view>
        <view class="ssr-item">情绪管理</view>
        <view class="ssr-item">娃娃队</view>
        <view class="ssr-item">8岁以上</view>
        <view class="ssr-item">6-8岁</view>
      </view>
    </view>
  </view>

  <view class="home-banner" hidden="{{isSearchShow}}">
    <image src="../../images/home_banner.jpg" mode="widthFix"></image>
  </view>

  <view class="filter-toolbar" hidden="{{isSearchShow}}">
    <view class="filter-itemtype sort">
     综合排序
     <text class="iconfont icon-caret-down"></text>
    </view>
    <view class="filter-itemtype">
     人气优先
    </view>
    <view class="filter-itemtype">
     新书优化
    </view>
    <view class="filter-itemtype filter">
     筛选
     <text class="iconfont icon-filter"></text>
    </view>

    <view class="filter-sublayer">
      <view class="filter-itemsort-wrap">
        <view class="filter-itemsort">综合排序</view>
        <view class="filter-itemsort">人气优先</view>
        <view class="filter-itemsort selected">好评优先</view>
        <view class="filter-itemsort">新书优先</view>
        <view class="filter-itemsort">智能排序</view>
      </view>

      <view class="filter-itemcatelog">
        <view class="filter-catelog-hd">
          <iconage name="leaf" type="svg"></iconage>
          年龄（单选）
        </view>
        <view class="filter-catelog-bd">
          <view class="filter-catelog-item">0-2岁</view>
          <view class="filter-catelog-item selected">2-4岁</view>
          <view class="filter-catelog-item">4-6岁</view>
          <view class="filter-catelog-item">6-8岁</view>
          <view class="filter-catelog-item">8岁以上</view>
        </view>
        <view class="filter-catelog-hd">
          <iconcate name="catelog" type="svg"></iconcate>
          分类（可多选）
        </view>
        <view class="filter-catelog-bd">
          <view class="filter-catelog-item">亲子共读</view>
          <view class="filter-catelog-item">育儿教育</view>
          <view class="filter-catelog-item">儿童启蒙</view>
          <view class="filter-catelog-item">经典童话</view>
          <view class="filter-catelog-item">育儿宝典</view>
          <view class="filter-catelog-item">启发想象</view>
        </view>
        <view class="filter-catelog-hd">
          <iconlang name="lang" type="svg"></iconlang>
          语言（单选）
        </view>
        <view class="filter-catelog-bd">
          <view class="filter-catelog-item">中文</view>
          <view class="filter-catelog-item">英文</view>
          <view class="filter-catelog-item">中英文</view>
          <view class="filter-catelog-item">中文注音</view>
        </view>
      </view>

    </view>

  </view>

  <view class="product-listview" hidden="{{isSearchShow}}">
    <view class="product-panel" @tap="viewDetail">
      <view class="product-cover">
        <image src="../../images/book1.png" mode="widthFix"></image>
      </view>
      <view class="product-panel-body">
        <view class="product-maininfo">
          <view class="product-caption">父与子全集(全10册)</view>
          <view class="product-author">汤佳</view>
          <view class="product-desc">亲子教育绘本第20名</view>
          <raty value="4.8"></raty>
          <view class="product-tags">
            <tag1>科普百科</tag1>
            <tag2>幽默风趣</tag2>
          </view>
        </view>
        <view class="product-subinfo">
          <view class="product-price">
            <text class="unit">￥</text>
            <text>29.9</text>
          </view>
          <view class="split"></view>
          <view class="product-tax">
            书费价 ￥5.25
          </view>
        </view>
      </view>
    </view>

    <view class="product-panel" @tap="viewDetail">
      <view class="product-cover">
        <image src="../../images/book1.png" mode="widthFix"></image>
      </view>
      <view class="product-panel-body">
        <view class="product-maininfo">
          <view class="product-caption">父与子全集(全10册)</view>
          <view class="product-author">汤佳</view>
          <view class="product-desc">亲子教育绘本第20名</view>
          <raty value="4.8"></raty>
          <view class="product-tags">
            <tag1>科普百科</tag1>
            <tag2>幽默风趣</tag2>
          </view>
        </view>
        <view class="product-subinfo">
          <view class="product-price">
            <text class="unit">￥</text>
            <text>29.9</text>
          </view>
          <view class="split"></view>
          <view class="product-tax">
            书费价 ￥5.25
          </view>
        </view>
      </view>
    </view>

    <view class="product-panel" @tap="viewDetail">
      <view class="product-cover">
        <image src="../../images/book1.png" mode="widthFix"></image>
      </view>
      <view class="product-panel-body">
        <view class="product-maininfo">
          <view class="product-caption">父与子全集(全10册)</view>
          <view class="product-author">汤佳</view>
          <view class="product-desc">亲子教育绘本第20名</view>
          <raty value="4.8"></raty>
          <view class="product-tags">
            <tag1>科普百科</tag1>
            <tag2>幽默风趣</tag2>
          </view>
        </view>
        <view class="product-subinfo">
          <view class="product-price">
            <text class="unit">￥</text>
            <text>29.9</text>
          </view>
          <view class="split"></view>
          <view class="product-tax">
            书费价 ￥5.25
          </view>
        </view>
      </view>
    </view>

  </view>
</template>

<script>
import wepy from 'wepy'
import Raty from '@/components/raty'
import Tag from '@/components/tag'
import Icon from '@/components/icon'

export default class Index extends wepy.page {
  config = {
    navigationBarTitleText: '星月童书'
  };

  components = {
    raty: Raty,
    tag1: Tag,
    tag2: Tag,
    iconage: Icon,
    iconcate: Icon,
    iconlang: Icon
  }

  data = {
    isSearchShow: false
  }

  methods = {
    showSearch () {
      this.isSearchShow = true
    },
    hideSearch () {
      this.isSearchShow = false
    },
    viewDetail () {
      this.$navigate('/pages/detail/detail')
    }
  }

  onLoad() {}
}
</script>
